<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	<!-- 目的:为 dao接口方法提供 sql语句 -->
<mapper namespace="moe.harusame.dao.WhisperDao">	

	<insert id="insertWhisper">
		insert ignore into whisper (sender_id, receiver_id, message_content)
		values (#{senderId}, #{receiverId}, #{messageContent})
	</insert>
	
	<select id="getWhisperList" resultType="Whisper">
		select message_id, sender_id, receiver_id, message_content, send_date
		from whisper
		where receiver_id = #{receiverId}
		and state = 0
		order by send_date
		asc
	</select>
	
	<select id="getAllWhisperList" resultType="Whisper">
		select message_id, sender_id, receiver_id, message_content, send_date
		from whisper
		where (
			receiver_id = #{userId}
			and 
			sender_id = #{friendId}
		)
		or (
			receiver_id = #{friendId}
			and 
			sender_id = #{userId}
		)
		and state = 0
		order by send_date
		asc
	</select>
	
</mapper>
